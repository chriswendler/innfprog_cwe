<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Karakterkalkulator</h1>
    <!--<form name="poengForm" onsubmit="checkInput()">-->
    <p>
        <label for="poengOppgave1">Poeng i Oppgave 1:</label>
        <input id="poengOppgave1" type="number" name="input1"/>
        <!--
        Hvorfor ingen closing tag av type '</input>'?: Denne lukker seg selv, 
        det er ikke mening at input skal ha et innebyget innhold.
        Type="number" medfører at brukeren kan kun skrive tall og komma, 
        likevel behandles dette i JS som en string og må konverteres-->
    </p>
    <p>
        <label for="poengOppgave2">Poeng i Oppgave 2:</label>
        <input id="poengOppgave2" type="number" name="input2">
    </p>
    <p>
        <button id="beregn" class="disabled" disabled>Beregn karakter</button>
    </p>
    <p>Karakter: <span id="karakter"></span></p>
<!--</form>-->
       


<script>
    var poengOppgave1, poengOppgave2;
    var maksPoengOppgave1 = 10, maksPoengOppgave2 = 12;
    var resultatProsent = "";

    // var poeng = [poengOppgave1, poengOppgave2]

    let karakter = "" // dette er testet med let karakter = "test"

    const grades = [
    // Jeg har korrigert stavning av "threshold"
    {grade: "F", threshold: 0},
    {grade: "E", threshold: 25},
    {grade: "D", threshold: 44},
    {grade: "C", threshold: 68},
    {grade: "B", threshold: 88},
    {grade: "A", threshold: 100}
    ]
    //console.log(grades[1]["grade"])
    //console.log(grades.length)

    const input1 = document.getElementById("poengOppgave1")
    const input2 = document.getElementById("poengOppgave2")
    const btn = document.getElementById("beregn")

    // Knappen skal ikke være aktiv når siden lastes. Den letteste veien virker å bruke boolean attribute
    // disabled, da slipper vi å bruke setAttribute og removeAttribute: 
    btn.disabled = true;
    
    function checkInput() {
        console.log("CkeckInput triggered");
        if(input1.value!=='' && input2.value!=='') {
        btn.disabled = false;
        btn.classList.remove("disabled")
        } else {
        // vi trenger else-delen for å deaktivere knappen igjen dersom verdiene i feltene fjernes
        btn.disabled = true;
        btn.classList.add("disabled") 
        }
    }

    // Input er en type event ved siden av f.eks. click. Side følger med om noe skjer i feltene,
    // og kaller funksjonen hver gang:
    input1.addEventListener("input", checkInput);
    input2.addEventListener("input", checkInput);
    

    // Merk at utregningsfunksjonen blir kalt som del av lagrePoeng-funkjsonen:
    function lagrePoeng () {
        poengOppgave1 = Number(document.getElementById("poengOppgave1").value)
        poengOppgave2 = Number(document.getElementById("poengOppgave2").value)
        console.log("Poengene som konvertert: " + poengOppgave1, poengOppgave2)
        utregning();
    };

    // Når brukeren trykker "Beregn karakter"-knappen, kalles laringsfunksjonen og med dette beregningsfunkjsonen:
    document.getElementById("beregn").addEventListener("click", lagrePoeng);

    function utregning () {
        resultatProsent = (0.3 * (poengOppgave1 / maksPoengOppgave1 * 100)) + (0.7 * (poengOppgave2 / maksPoengOppgave2 * 100))
        console.log("Resultatprosent i utregningen: " + resultatProsent);

        // Vi bruker en løkke for å gå gjennom hver karakter i skalaen. For hver karakter, sjekker vi om prosenttallet er over terskelen 
        for(var gi = 0; gi < grades.length; gi++) {

        // I if() nedenfor ble det oppdaget at grades[gi]["threshold"] resulterte i undefined fordi ordet threshold var feilstavet 
        // i karakterskalaen i teksten i Arbeidskravet  

            if(resultatProsent >= grades[gi]["threshold"]) {  
            // Konsolutskriften formulert her med template literal ${grades[gi]["threshold"] er foreslått av ChatGPT, men 
            // man hadde også fått "undefined" ved å skrive enkelt: console.log(grades[gi]["threshold"]); 
            console.log(`Checking if ${resultatProsent} >= ${grades[gi]["threshold"]}`);
            karakter = grades[gi]["grade"];
            // Konsolutskriften observer hvor mange ganger løkken kjører:  
            console.log(`Current matching grade: ${karakter}`);
            } 
            console.log(karakter);

            document.getElementById("karakter").innerHTML = karakter;
        
            // Her er det avgjørende å ikke inkludere break; da dette vil avbryte etter sjekk av første key-value par ("F").
        // En annen løsning hadde vært å snu skalaen på hodet, da hadde funkjsonen satt "A" først også jobbet seg nedover 
        // til betingelsen ikke lengre var sant.
        // En mer treffsikker vei å kode karakterskalaen på, er modellen brukt i videoøvelsen Svantes karakter på LMS, i dette tilfelle
        // kunne man skrive {grade: "F", minProsent: 0, maxProsent 24} og derettter sjekket om
        // resultatProsent <= grades[gi]["maxProsent"] && resultatProsent >= grades[gi]["minProsent"])
        // men jeg har ikke gjort det for å holde meg til skalaen gitt i oppgavestillingen
   
        } // her avslutter for-loekken
    } // her avslutter funksjon utregning 

</script>
    
</body>
</html>

<!--Karakterkalkulatoren må møte følgende krav:

1. Brukeren skal fylle inn to felter, et for poengene som er oppnådd på eksamensoppgave 1 og et for poengene oppnådd på eksamensoppgave 2.
2. Brukeren skal kunne klikke på en knapp kalt "Beregn karakter". 
Knappen skal kun fungere dersom det er fylt inn informasjon i de to feltene fra punkt 1.
3. Når brukeren trykker "Beregn karakter"-knappen, skal systemet bruke formelen for å regne ut riktig svar-prosent, 
og bruke denne for å finne riktig karakter i karakterskalaen.
4. Når systemet har funnet riktig karakter, skal karakteren vises til brukeren på nettsiden.
-->